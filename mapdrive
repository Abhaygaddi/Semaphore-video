- name: Copy and run Map.exe on Windows Server
  hosts: WIN2016
  gather_facts: no
  tasks:

    - name: Ensure C:\temp directory exists
      win_file:
        path: C:\temp
        state: directory

    - name: Copy Map.exe from UNC path to C:\temp
      win_command: >
        powershell.exe -Command "Copy-Item '\\192.168.29.132\Patches\Map.exe' -Destination 'C:\temp\Map.exe' -Force"

    - name: Run Map.exe from C:\temp
      win_command: C:\temp\Map.exe
