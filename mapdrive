---
- name: Copy Map.exe to another Windows server
  hosts: all
  gather_facts: no
  tasks:
    - name: Copy Map.exe from one Windows server to another
      win_copy:
        src: '\\192.168.29.132\Patches\Map.exe'
        dest: 'C:\temp\Map.exe'
        remote_src: yes
        remote_user: 'testdc\ansible'  # Use domain\username
        remote_password: '0pT1mus9r1me#'
        become: yes
        become_method: runas
    - name: Run Map.exe as administrator
      win_shell: |
        Start-Process -FilePath "C:\temp\Map.exe" -Verb runas
      become: yes
      become_method: runas
