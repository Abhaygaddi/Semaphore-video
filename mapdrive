---
- name: Install patches from network share
  hosts: windows
  gather_facts: yes
  
  tasks:
    - name: Map network drive Z
      win_mapped_drive:
        letter: Z
        path: '\\192.168.29.132\Patches'
        state: present

    - name: Install Patch KB5058921.msu
      win_shell: |
        Start-Process wusa -ArgumentList "Z:\KB5058921.msu /quiet /norestart" -Verb runAs
      become: no  # Remove become since we are using 'runAs' for admin privileges

    - name: Install Patch KB5055521.msu
      win_shell: |
        Start-Process wusa -ArgumentList "Z:\KB5055521.msu /quiet /norestart" -Verb runAs
      become: no  # Remove become since we are using 'runAs' for admin privileges
