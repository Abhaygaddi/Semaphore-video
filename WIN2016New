---
- name: Install Windows patch from network share without copying or mapping
  hosts: windows
  gather_facts: no
  vars:
    patch_path: "\\\\192.168.29.78\\winpatches\\KB5058921.msu"

  tasks:
    - name: Install Windows patch using wusa from UNC path
      ansible.windows.win_command:
        cmd: 'cmd.exe /c wusa.exe "{{ patch_path }}" /quiet /norestart'
      register: patch_result
      failed_when: patch_result.rc != 0
      changed_when: patch_result.rc == 0

    - name: Show patch installation result
      debug:
        var: patch_result
